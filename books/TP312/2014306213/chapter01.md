---
name: '初识 Express - 1 - Node 与 Express 开发'
---

# 第 1 章 初识 Express

[[TOC]]

## 1.1 JavaScript 革命

最初 JavaScript 只是一个粗陋的客户端脚本语言，现在 JavaScript 不仅是客户端通用的脚本语言，
并且在 Node 的加持下一举成为热门的服务器端脚本语言。

现在的 JavaScript 技术栈十分明朗，从客户端到服务器端开发不需要环境切换，可谓是轻车熟路。
但这并不意味着服务器端编程只和语言有关，其中还有很多其他知识需要学习。

由于历史原因，人们一直对 JavaScript 脚本持有 “只是一个玩具” 的偏见，
而现在的 JavaScript 可谓是强大、灵活和优雅。

2009 年 Ryan Dahl 看到了 JavaScript 作为服务器端语言的潜力，于是 Node 诞生了。

这是一个互联网技术生机勃勃的时代。

- Ruby 吸收了学院派计算机科学的一些伟大的思想，并结合了自有的一些新思想，
  推出了一种更快捷的网站及 Web 应用程序构建方式。
- 微软也通过奋勇作战在互联网时代争取了一席之地，借助 .NET 取得了惊人的成就，
  它不仅借鉴了 Ruby 和 JavaScript 的优点，还从 Java 犯的错误中吸取了经验，
  并充分吸收了学术殿堂中的精髓。

徜徉在互联网技术中令人感到兴奋，到处都是令人惊奇的新想法。

## 1.2 初识 Express

> Express 是一种保持最低程度规模、高度包容、快速而极简的 Node.js Web 框架，
> 为 Web 和移动应用程序提供一组强大的功能。
>
> - <http://expressjs.com/zh-cn/>

- 精简
  - Express 最吸引人的特性之一。 Express 的哲学是在你的想法和服务器之间充当薄薄的一层，
    在提供有用特性的同时，尽量不干预开发者实现自己的想法。
- 灵活
  - Express 哲学中的另一个关键点就是可扩展。
  - Express 提供了一个非常精简的框架，应用开发者可以根据自己的需要添加 Express
    功能中的不同部分，随时替换掉不满足需要的部分。
- Web 程序框架
  - 网站和网页都是 Web 程序。
- 单页 Web 程序
  - 单页 Web 程序是将整个网站（或其中很大部分）下载的客户端浏览器上。
  - 经过初次加载后，页面几乎不需要或只是进行很少的服务端通信，
    使用户以更快的速度访问不同的页面内容。
  - 单页程序的开发可以使用 Angular 或 Ember 等流行框架，
    Express 跟它们都配合的很好。
- 多页和混合的 Web 程序
  - 多页 Web 程序是比较传统的方式。网站上的每个页面都是通过向服务器发起单独的请求得到的。
  - 单页面和多页面程序都有各自的优点，你可以决定哪些内容适合作为单页面呈现，哪些应该通过不同的请求提供。
  - 同时使用单页和多页两种方式的网站，可以称之为混合 Web 程序。

## 1.3 Express 简史

Express 的缔造者 TJ Holowaychuk 说 Express 是在 Sinatra 的启发下创建的，后者是一个基于 Ruby 的框架。

除了 Sinatra ， Express 跟 Connect 也有非常紧密的联系， Connect 是一个 Node 插件库。

- Connect 创造了 中间件 ( Middleware ) 这个术语来描述插入式的 Node 模块，它能在不同程度上处理 Web 请求。
- 在版本 4.0 之前， Express 一直是绑定 Connect 的。
- 在版本 4.0 中， Connect （以及除 static 之外的所有中间件）被去掉了，以便这些中间件可以各自独立升级。

## 1.4 升级到 Express 4.0

- Connect 已经从 Express 中去掉了。
- body-parser 现在有自己的包了，它不再包含 multipart 中间件。
- 不必再将 Express router 链接到程序里。
- `app.configure` 被去掉了，只需检查 `app.get(env)` （用 switch 或 if 语句）就可以取代该方法。

## 1.5 Node : 一种新型 Web 服务器

从某种角度看， Node 跟其他流行 Web 服务器，比如微软的互联网信息服务 ( IIS ) 或 Apache ，有许多共同点。

Node 跟传统 Web 服务器相比，主要区别有：

- Node 的搭建和配置非常容易。
- Node 是单线程的。单线程极大地简化了 Web 程序的编写。
- 相较于 .NET 或 Java 程序， Node 程序的编写方式更像 PHP 或 Ruby 等解释性语言，
  虽然 JavaScript 引擎（谷歌的 V8 ）确实是将 JavaScript 编译为本地机器码（更像 C 或 C++ ），
  但这一操作是透明（即时）的。
- Node 程序是平台无关的，在主流操作系统上都能轻松快速的构建出一个可运行的服务器。

## 1.6 Node 的生态系统

除了最简单的 Web 程序，所有的程序都需要数据库。

Node 生态系统中除了提供所有主流 **关系型数据库** ( MySQL, MariaDB, PostgreSQL, Oracle, SQL Server )
的接口外，也带动了一批称之为 “NoSQL 数据库” 的发展。

- “NoSQL 数据库” 更准确的可以称之为 “文档数据库” 或 “键值对数据库”，
  它们提供了一种概念上更简单的数据存储方式。
- **文档型数据库** 有很多，其中 MongoDB 是佼佼者。

因为构建一个功能性网站需要用到多种技术，所以衍生出一种用来描述网站构建基础 “技术栈” 的缩略语。

- 比如 Linux, Apache, MySQL, PHP 被称为 LAMP 技术栈。
- MongoDB 工程师 Valeri Karpov 发明了一个缩略语 MEAN 用来指代 Mongo, Express, Angular, Node 技术栈。
- 尽管 MEAN 朗朗上口，却也具有局限性，比如可选的数据库和应用程序框架有多种，也漏掉了一个非常重要的组件：模板引擎。

对于本书而言 “JavaScript 技术栈” 指的是 Node, Express 和 MongoDB 。

## 1.7 授权

在开发 Node 程序时，也要关注依赖包的授权问题。

Node 开发包中最常见的时 MIT 授权，它几乎允许你做任何事情，但你也可能会遇到下面几种授权：

- GNU 通用公共授权 ( GPL )

  - GPL 是非常流行的开源授权，如果你项目中使用了 GPL 授权的代码，那么你的项目也必须是 GPL 授权的。
    也就意味着你的项目不能是闭源的。

- Apache 2.0

  - 跟 MIT 类似，你可以为自己的项目使用不同的授权，包括闭源的。
    但是你必须对那些使用 Apache 2.0 授权的库做出声明。

- 伯克利软件分发 ( BSD )

  - 与 Apache 类似，自己的项目可以使用任何授权，同时必须声明使用了 BSD 授权的库。

> 软件有时是双授权的，比如 GPL 和 MIT 双授权。

作为一个开发者，在编写自己的包时，应该做一个善良的人，选一个授权并在文档中正确声明。
一般而言，若深挖源码才能确定所用的开发包是什么授权，是非常恐怖的。或者更糟的情况是，发现它根本没有授权。
